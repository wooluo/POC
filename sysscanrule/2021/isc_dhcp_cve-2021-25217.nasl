
#
# 
#


include('compat.inc');

if (description)
{
  script_id(150053);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2021/05/28");

  script_cve_id("CVE-2021-25217");

  script_name(english:"ISC DHCP < 4.4.2-P1 DoS");

  script_set_attribute(attribute:"synopsis", value:
"The DHCP server installed on the remote Linux host is affected by a denial of service vulnerability.");
  script_set_attribute(attribute:"description", value:
"The ISC DHCP server installed on the remote host is prior to 4.4.2-P1. It is, therefore, vulnerable to a a buffer
overwrite possible when parsing hexadecimal literals with more than 1024 octets. An attacker could exploit this to
cause the DHCP server to crash.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version 
number.");
  script_set_attribute(attribute:"solution", value:
"Upgrade the affected DHCP server to version 4.4.2-P1 or later.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2021-25217");

  script_set_attribute(attribute:"vuln_publication_date", value:"2021/05/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2021/05/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2021/05/28");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:isc:dhcp");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2021 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("dhcp_detect.nbin");
  script_require_keys("dhcp_server/type", "dhcp_server/version");

  exit(0);
}

var app = 'ISC DHCP';
var fix = '4.4.2-P1';

var type = get_kb_item_or_exit('dhcp_server/type');
if ('isc-dhcp' >!< type) audit(AUDIT_NOT_INST, app);

var version = get_kb_item_or_exit('dhcp_server/version');

if (version =~ "^[0-9]+\.[0-9]+$")
  audit(AUDIT_VER_NOT_GRANULAR, app, version);

if (report_paranoia < 2) audit(AUDIT_PARANOID);

if (ver_compare(fix:fix, ver:version, regexes:{0:"-P(\d+)"}, strict:FALSE) < 0)
{
  report = '\n  Installed version : ' + version +
           '\n  Fixed version     : ' + fix + '\n';
  security_report_v4(severity:SECURITY_NOTE, port:0, extra:report);
}
else audit(AUDIT_INST_VER_NOT_VULN, app, version);
